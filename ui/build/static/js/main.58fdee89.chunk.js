(this["webpackJsonpaz-function-as-a-graph-ui"]=this["webpackJsonpaz-function-as-a-graph-ui"]||[]).push([[0],{247:function(e,t,n){},492:function(e,t,n){var r={"./locale":218,"./locale.js":218};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id=492},495:function(e,t,n){"use strict";n.r(t);var r,o=n(0),a=n.n(o),i=n(11),c=n.n(i),s=(n(247),n(98)),l=n(99),u=n(228),d=n(227),g=n(226),h=n(522),p=n(525),b=n(231),v=n(526),m=n(531),f=n(533),y=n(527),j=n(528),O=n(529),x=n(530),_=n(534),w=n(224),C=n.n(w),P=n(225),N=n.n(P),k=n(8),B=Object(g.a)(r=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){if(window.location.search.startsWith("?path=")){var e=this.props.state;e.pathText=decodeURIComponent(window.location.search.substr(6)),e.load()}}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("function")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("orchestrator")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("activity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("entity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("proxy")))}},{key:"render",value:function(){var e=this,t=this.props.state;return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(h.a,{position:"static",color:"default",children:Object(k.jsxs)(p.a,{children:[Object(k.jsx)(b.a,{variant:"h5",color:"inherit",className:"title-typography",children:Object(k.jsx)(v.a,{color:"inherit",href:window.location.origin+window.location.pathname,children:"Azure Functions as a Graph"})}),Object(k.jsx)(m.a,{fullWidth:!0,className:"filter-textfield",margin:"dense",label:"GitHub link or local path to Functions project",InputLabelProps:{shrink:!0},placeholder:"e.g. 'https://github.com/scale-tone/repka-durable-func'",disabled:t.inProgress,value:t.pathText,onChange:function(e){return t.pathText=e.target.value},onKeyPress:function(t){return e.handleKeyPress(t)}}),Object(k.jsx)(f.a,{width:30}),Object(k.jsx)(y.a,{className:"filter-button",variant:"outlined",color:"secondary",size:"large",disabled:t.inProgress||!t.pathText,onClick:function(){return t.load()},children:"Visualize"})]})}),!!t.inProgress&&Object(k.jsx)(j.a,{}),!!t.functionsLoaded&&Object(k.jsxs)(O.a,{row:!0,className:"settings-group",children:[Object(k.jsx)(x.a,{control:Object(k.jsx)(_.a,{color:"default",disabled:t.inProgress,checked:t.renderFunctions,onChange:function(e){return t.renderFunctions=e.target.checked}}),label:"Show Functions"}),Object(k.jsx)(x.a,{control:Object(k.jsx)(_.a,{color:"default",disabled:t.inProgress,checked:t.renderProxies,onChange:function(e){return t.renderProxies=e.target.checked}}),label:"Show Proxies"})]}),!!t.error&&Object(k.jsx)(b.a,{className:"error-typography",color:"error",variant:"h5",children:t.error}),!!t.diagramSvg&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{className:"diagram-div",dangerouslySetInnerHTML:{__html:this.getStyledSvg(t.diagramSvg)}}),Object(k.jsxs)(p.a,{variant:"dense",className:"bottom-toolbar",children:[Object(k.jsxs)(y.a,{variant:"outlined",color:"default",disabled:t.inProgress,onClick:function(){return window.navigator.clipboard.writeText(t.diagramCode)},children:[Object(k.jsx)(C.a,{}),Object(k.jsx)(f.a,{width:10}),Object(k.jsx)(b.a,{color:"inherit",children:"Copy diagram code to Clipboard"})]}),Object(k.jsx)(f.a,{width:20}),Object(k.jsxs)(y.a,{variant:"outlined",color:"default",disabled:t.inProgress,href:URL.createObjectURL(new Blob([this.getStyledSvg(t.diagramSvg)],{type:"image/svg+xml"})),download:"functions.svg",children:[Object(k.jsx)(N.a,{}),Object(k.jsx)(f.a,{width:20}),Object(k.jsx)(b.a,{color:"inherit",children:"Save as .SVG"})]}),Object(k.jsx)(f.a,{width:20})]})]}),Object(k.jsx)("a",{className:"github-link",href:"https://github.com/scale-tone/az-func-as-a-graph#az-func-as-a-graph",target:"_blank",rel:"noreferrer",children:Object(k.jsx)("img",{loading:"lazy",width:"149",height:"149",src:"https://github.blog/wp-content/uploads/2008/12/forkme_right_white_ffffff.png?resize=149%2C149",alt:"Fork me on GitHub","data-recalc-dims":"1"})})]})}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.load())}},{key:"mountClickEventToFunctionNodes",value:function(e){for(var t=this.props.state,n=0;n<e.length;n++){var r=e[n],o=/flowchart-(.+)-/.exec(r.id);o&&function(){var e=o[1];r.onclick=function(){return t.gotoFunctionCode(e)},r.style.cursor="pointer"}()}}},{key:"getStyledSvg",value:function(e){return e.replace("</style>",".label > g > text { transform: translateX(25px); }</style>")}}]),n}(a.a.Component))||r,S=n(36),F=(n(253),n(16)),T=n(5),z=n(130),R=n.n(z),D=n(131),E=n.n(D),L=n(229),q=n(104),I="#32;";function U(e){var t,n,r,o,a,i,c;switch(e.type){case"httpTrigger":return"".concat("anonymous"===e.authLevel?"#127760;":"#128274;"," http").concat(e.methods?":["+e.methods.join(",")+"]":"").concat(e.route?":"+e.route:"");case"blobTrigger":return"".concat(I,"blob:").concat(null!==(t=e.path)&&void 0!==t?t:"");case"cosmosDBTrigger":return"".concat(I,"cosmosDB:").concat(null!==(n=e.databaseName)&&void 0!==n?n:"",":").concat(null!==(r=e.collectionName)&&void 0!==r?r:"");case"eventHubTrigger":return"".concat(I,"eventHub:").concat(null!==(o=e.eventHubName)&&void 0!==o?o:"");case"serviceBusTrigger":return"".concat(I,"serviceBus:").concat(e.queueName?e.queueName:null!==(a=e.topicName)&&void 0!==a?a:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queueTrigger":return"".concat(I,"queue:").concat(null!==(i=e.queueName)&&void 0!==i?i:"");case"timerTrigger":return"".concat(I,"timer:").concat(null!==(c=e.schedule)&&void 0!==c?c:"");default:return"".concat(I).concat(e.type)}}function H(e){var t,n,r,o,a,i,c;switch(e.type){case"table":return"".concat(I,"table:").concat(null!==(t=e.tableName)&&void 0!==t?t:"");case"blob":return"".concat(I,"blob:").concat(null!==(n=e.path)&&void 0!==n?n:"");case"cosmosDB":return"".concat(I,"cosmosDB:").concat(null!==(r=e.databaseName)&&void 0!==r?r:"",":").concat(null!==(o=e.collectionName)&&void 0!==o?o:"");case"eventHub":return"".concat(I,"eventHub:").concat(null!==(a=e.eventHubName)&&void 0!==a?a:"");case"serviceBus":return"".concat(I,"serviceBus:").concat(e.queueName?e.queueName:null!==(i=e.topicName)&&void 0!==i?i:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queue":return"".concat(I,"queue:").concat(null!==(c=e.queueName)&&void 0!==c?c:"");default:return"".concat(I).concat(e.type)}}var J,W,G,M,A,K,V,$,X,Q=150;function Y(e){if(!e)return"--\x3e";var t=JSON.stringify(e).replace(/"/g,"'").replace(/'backend.request./g,"'");return t.length>Q&&(t=t.substr(0,Q)+"..."),'-- "'.concat(t).concat(I,'" --\x3e')}function Z(e){if(!e)return"--\x3e";e["response.body"]&&(e["response.body"]="...");var t=JSON.stringify(e).replace(/"/g,"'").replace(/'response./g,"'");return t.length>Q&&(t=t.substr(0,Q)+"..."),'-- "'.concat(t).concat(I,'" --\x3e')}var ee=(J=function(){function e(){Object(s.a)(this,e),Object(S.a)(this,"pathText",W,this),Object(S.a)(this,"_error",G,this),Object(S.a)(this,"_diagramCode",M,this),Object(S.a)(this,"_diagramSvg",A,this),Object(S.a)(this,"_inProgress",K,this),Object(S.a)(this,"_renderFunctions",V,this),Object(S.a)(this,"_renderProxies",$,this),Object(S.a)(this,"_traversalResult",X,this),this._iconsSvg=void 0,this._iconsSvgPromise=R.a.get("static/icons/all-azure-icons.svg"),E.a.initialize({startOnLoad:!0,flowchart:{curve:"Basis",useMaxWidth:!0,htmlLabels:!1}})}return Object(l.a)(e,[{key:"diagramSvg",get:function(){return this._diagramSvg}},{key:"diagramCode",get:function(){return this._diagramCode}},{key:"error",get:function(){return this._error}},{key:"inProgress",get:function(){return this._inProgress}},{key:"functionsLoaded",get:function(){return!!this._traversalResult}},{key:"renderFunctions",get:function(){return this._renderFunctions},set:function(e){this._renderFunctions=e,this.render()}},{key:"renderProxies",get:function(){return this._renderProxies},set:function(e){this._renderProxies=e,this.render()}},{key:"render",value:function(){var e=this;if(this._diagramCode="",this._diagramSvg="",this._error="",this._traversalResult){this._inProgress=!0;try{var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";if(!n.doNotRenderFunctions){var o=[];for(var a in e){var i,c=e[a],s=void 0,l=[],u=[],d=[],g="".concat(a,'{{"').concat(I).concat(a,'"}}:::function'),h=Object(q.a)(c.bindings);try{for(h.s();!(i=h.n()).done;){var p=i.value;"orchestrationTrigger"===p.type?g="".concat(a,'[["').concat(I).concat(a,'"]]:::orchestrator'):"activityTrigger"===p.type?g="".concat(a,'[/"').concat(I).concat(a,'"/]:::activity'):"entityTrigger"===p.type&&(g="".concat(a,'[("').concat(I).concat(a,'")]:::entity')),p.type.endsWith("Trigger")?s=p:"in"===p.direction?l.push(p):"out"===p.direction?u.push(p):d.push(p)}}catch(A){h.e(A)}finally{h.f()}o.push(Object(L.a)({name:a,nodeCode:g,triggerBinding:s,inputBindings:l,outputBindings:u,otherBindings:d},c))}var b=function(e){var t;return(!(null===(t=e.isCalledBy)||void 0===t?void 0:t.length)&&e.triggerBinding&&e.triggerBinding.type?e.triggerBinding.type:"")+"~"+e.name};o.sort((function(e,t){var n=b(e),r=b(t);return n>r?1:r>n?-1:0}));for(var v=0,m=o;v<m.length;v++){var f,y,j=m[v];if(r+="".concat(j.nodeCode,"\n"),r+="style ".concat(j.name," fill:#D9D9FF,stroke-width:2px\n"),null===(f=j.isCalledBy)||void 0===f?void 0:f.length){var O,x=Object(q.a)(j.isCalledBy);try{for(x.s();!(O=x.n()).done;){var _=O.value;r+="".concat(_," ---\x3e ").concat(j.name,"\n")}}catch(A){x.e(A)}finally{x.f()}}else j.triggerBinding&&(r+="".concat(j.name,".").concat(j.triggerBinding.type,'>"').concat(U(j.triggerBinding),'"]:::').concat(j.triggerBinding.type," --\x3e ").concat(j.name,"\n"));for(var w=0;w<j.inputBindings.length;w++){var C=j.inputBindings[w];r+="".concat(j.name,".").concat(w,".").concat(C.type,'(["').concat(H(C),'"]):::').concat(C.type," -.-> ").concat(j.name,"\n")}for(w=0;w<j.outputBindings.length;w++){var P=j.outputBindings[w];r+="".concat(j.name," -.-> ").concat(j.name,".").concat(w,".").concat(P.type,'(["').concat(H(P),'"]):::').concat(P.type,"\n")}for(w=0;w<j.otherBindings.length;w++){var N=j.otherBindings[w];r+="".concat(j.name," -.- ").concat(j.name,".").concat(w,".").concat(N.type,'(["').concat(H(N),'"]):::').concat(N.type,"\n")}if(null===(y=j.isSignalledBy)||void 0===y?void 0:y.length){var k,B=Object(q.a)(j.isSignalledBy);try{for(B.s();!(k=B.n()).done;){var S=k.value;r+="".concat(S.name,' -- "#9889; ').concat(S.signalName,'" ---\x3e ').concat(j.name,"\n")}}catch(A){B.e(A)}finally{B.f()}}j.isCalledByItself&&(r+="".concat(j.name,' -- "[ContinueAsNew]" --\x3e ').concat(j.name,"\n"))}}if(!n.doNotRenderProxies&&Object.keys(t).length>0){var F="#FFE6C8",T="",z=!1;for(var R in t){var D=t[R],E=R.replace(/ /g,"");z=D.warningNotAddedToCsProjFile,T="",D.matchCondition&&(D.matchCondition.methods&&D.matchCondition.methods.length&&(T+=(T?":":"")+"[".concat(D.matchCondition.methods.join(","),"]")),D.matchCondition.route&&(T+=(T?":":"")+D.matchCondition.route)),T||(T=R);var J="proxy.".concat(E);if(r+='proxies.json -. "'.concat(R,'" .-> ').concat(J,'(["').concat(I).concat(T,'"]):::proxy\n'),r+="style ".concat(J," fill:").concat(F,"\n"),D.backendUri){T=D.backendUri.replace(/'response./g,"'");var W="proxy.".concat(E,".backendUri");r+="".concat(J," ").concat(Y(D.requestOverrides)," ").concat(W,'["').concat(I).concat(T,'"]:::http\n'),r+="style ".concat(W," fill:").concat(F,"\n"),J=W}var G="proxy.".concat(E,".response");r+="".concat(J," ").concat(Z(D.responseOverrides)," ").concat(G,'(["').concat(I,'."]):::http\n'),r+="style ".concat(G," fill:").concat(F,"\n")}T="proxies.json";var M=F;z&&(T+=" #9888; Not added to .CSPROJ file!",M="#FF8080"),r+='proxies.json["'.concat(I).concat(T,'"]\n'),r+="style proxies.json fill:".concat(M,"\n")}return r}(this._traversalResult.functions,this._traversalResult.proxies,{doNotRenderFunctions:!this._renderFunctions,doNotRenderProxies:!this._renderProxies});if(!t)return void(this._inProgress=!1);this._diagramCode="graph LR\n".concat(t),E.a.render("mermaidSvgId",this._diagramCode,(function(t){e._diagramSvg=e.applyIcons(t),e._inProgress=!1}))}catch(n){this._error="Diagram rendering failed: ".concat(n.message),this._inProgress=!1}}}},{key:"load",value:function(){var e=this;if(!this._inProgress&&this.pathText){this._inProgress=!0,this._diagramCode="",this._diagramSvg="",this._error="",this._traversalResult=null;var t=this.pathText;window.history.replaceState(null,null,"?path=".concat(encodeURIComponent(t))),this.pathText="";var n=R.a.post("a/p/i/traverse-func",t);Promise.all([n,this._iconsSvgPromise]).then((function(t){e._traversalResult=t[0].data,e._iconsSvg=t[1].data,e.render()}),(function(t){e._error="Parsing failed: ".concat(t.message,".").concat(t.response?t.response.data:""),e._inProgress=!1}))}}},{key:"gotoFunctionCode",value:function(e){var t=null;(t=e.startsWith("proxy.")?this._traversalResult.proxies[e.substr(6)]:this._traversalResult.functions[e])&&t.filePath&&window.open(t.filePath)}},{key:"applyIcons",value:function(e){return e=(e=e.replace("><style>",">\n<defs>\n".concat(this._iconsSvg,"</defs>\n<style>"))).replace(/<g class="node (\w+).*?<g class="label" transform="translate\([0-9,.-]+\)"><g transform="translate\([0-9,.-]+\)">/g,'$&<use href="#az-icon-$1" width="20px" height="20px"/>')}}]),e}(),Object(F.a)(J.prototype,"diagramSvg",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"diagramSvg"),J.prototype),Object(F.a)(J.prototype,"diagramCode",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"diagramCode"),J.prototype),Object(F.a)(J.prototype,"error",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"error"),J.prototype),W=Object(F.a)(J.prototype,"pathText",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(F.a)(J.prototype,"inProgress",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"inProgress"),J.prototype),Object(F.a)(J.prototype,"functionsLoaded",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"functionsLoaded"),J.prototype),Object(F.a)(J.prototype,"renderFunctions",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"renderFunctions"),J.prototype),Object(F.a)(J.prototype,"renderProxies",[T.f],Object.getOwnPropertyDescriptor(J.prototype,"renderProxies"),J.prototype),G=Object(F.a)(J.prototype,"_error",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(F.a)(J.prototype,"_diagramCode",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(F.a)(J.prototype,"_diagramSvg",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(F.a)(J.prototype,"_inProgress",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(F.a)(J.prototype,"_renderFunctions",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$=Object(F.a)(J.prototype,"_renderProxies",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),X=Object(F.a)(J.prototype,"_traversalResult",[T.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J);c.a.render(Object(k.jsx)(B,{state:new ee}),document.getElementById("root"))}},[[495,1,2]]]);
//# sourceMappingURL=main.58fdee89.chunk.js.map