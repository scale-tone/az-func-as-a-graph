{"version":3,"sources":["../node_modules/moment-mini/locale sync /^/.*$","App.tsx","buildFunctionDiagramCode.ts","AppState.ts","index.tsx"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","App","observer","window","location","search","startsWith","state","this","props","pathText","decodeURIComponent","substr","load","AppBar","position","color","Toolbar","Typography","variant","className","Link","href","origin","pathname","TextField","fullWidth","margin","label","InputLabelProps","shrink","placeholder","disabled","inProgress","value","onChange","evt","target","onKeyPress","handleKeyPress","Box","width","Button","size","onClick","LinearProgress","error","diagramSvg","dangerouslySetInnerHTML","__html","navigator","clipboard","writeText","diagramCode","URL","createObjectURL","Blob","type","download","rel","loading","height","src","alt","data-recalc-dims","event","key","preventDefault","React","Component","space","getTriggerBindingText","binding","methods","join","route","path","databaseName","collectionName","eventHubName","queueName","topicName","subscriptionName","schedule","getBindingText","tableName","AppState","_iconsSvgPromise","axios","get","mermaid","initialize","startOnLoad","flowchart","curve","useMaxWidth","htmlLabels","_diagramSvg","_diagramCode","_error","_inProgress","projectPath","history","replaceState","encodeURIComponent","traversedFunctionsPromise","post","Promise","all","then","responses","funcs","functions","name","func","triggerBinding","undefined","inputBindings","outputBindings","otherBindings","nodeCode","bindings","endsWith","direction","push","sort","f1","f2","s1","isCalledBy","length","s2","calledBy","inputBinding","outputBinding","otherBinding","isSignalledBy","signalledBy","signalName","isCalledByItself","buildFunctionDiagramCode","data","iconsSvg","render","svg","applyIcons","err","message","response","replace","computed","observable","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.cf964bde.chunk.js","sourcesContent":["var map = {\n\t\"./locale\": 216,\n\t\"./locale.js\": 216\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 486;","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { AppBar, Box, Button, LinearProgress, Link, TextField, Toolbar, Typography } from '@material-ui/core';\r\n\r\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\n\r\nimport { AppState } from './AppState';\r\n\r\n@observer\r\nexport default class App extends React.Component<{ state: AppState }> {\r\n\r\n    componentDidMount() {\r\n\r\n        if (window.location.search.startsWith('?path=')) {\r\n         \r\n            const state = this.props.state;\r\n            state.pathText = decodeURIComponent(window.location.search.substr(6));\r\n            state.load();\r\n        }\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n\r\n            <AppBar position=\"static\" color=\"default\">\r\n                <Toolbar>\r\n\r\n                    <Typography variant=\"h5\" color=\"inherit\" className=\"title-typography\">\r\n                        <Link color=\"inherit\" href={window.location.origin + window.location.pathname}>\r\n                            Azure Functions as a Graph\r\n                        </Link>\r\n                    </Typography>\r\n\r\n                    <TextField\r\n                        fullWidth\r\n                        className=\"filter-textfield\"\r\n                        margin=\"dense\"\r\n                        label=\"GitHub link or local path to Functions project\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        placeholder=\"e.g. 'https://github.com/scale-tone/repka-durable-func'\"\r\n                        disabled={state.inProgress}\r\n                        value={state.pathText}\r\n                        onChange={(evt) => state.pathText = evt.target.value as string}\r\n                        onKeyPress={(evt: React.KeyboardEvent<HTMLInputElement>) => this.handleKeyPress(evt)}\r\n                    />\r\n\r\n                    <Box width={30} />\r\n\r\n                    <Button\r\n                        className=\"filter-button\"\r\n                        variant=\"outlined\"\r\n                        color=\"secondary\"\r\n                        size=\"large\"\r\n                        disabled={state.inProgress || !state.pathText}\r\n                        onClick={() => state.load()}\r\n                    >\r\n                        Visualize\r\n                    </Button>\r\n                </Toolbar>\r\n            </AppBar>\r\n\r\n            {!!state.inProgress && (<LinearProgress />)}\r\n\r\n            {!!state.error && (<Typography className=\"error-typography\" color=\"error\" variant=\"h5\" >{state.error}</Typography>)}\r\n\r\n            {!!state.diagramSvg && (<>\r\n                <div className=\"diagram-div\"\r\n                    dangerouslySetInnerHTML={{ __html: state.diagramSvg }}\r\n                />\r\n\r\n                <Toolbar variant=\"dense\" className=\"bottom-toolbar\">\r\n\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        color=\"default\"\r\n                        disabled={state.inProgress}\r\n                        onClick={() => window.navigator.clipboard.writeText(state.diagramCode)}\r\n                    >\r\n                        <FileCopyIcon />\r\n                        <Box width={10} />\r\n                        <Typography color=\"inherit\">Copy diagram code to Clipboard</Typography>\r\n                    </Button>\r\n\r\n                    <Box width={20} />\r\n\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        color=\"default\"\r\n                        disabled={state.inProgress}\r\n                        href={URL.createObjectURL(new Blob([state.diagramSvg], { type: 'image/svg+xml' }))}\r\n                        download={'functions.svg'}\r\n                    >\r\n                        <SaveIcon />\r\n                        <Box width={20} />\r\n                        <Typography color=\"inherit\">Save as .SVG</Typography>\r\n                    </Button>\r\n\r\n                    <Box width={20} />\r\n                </Toolbar>\r\n            </>)}\r\n\r\n            <a className=\"github-link\" href=\"https://github.com/scale-tone/az-func-as-a-graph#az-func-as-a-graph\" target=\"_blank\" rel=\"noreferrer\">\r\n                <img loading=\"lazy\" width=\"149\" height=\"149\" src=\"https://github.blog/wp-content/uploads/2008/12/forkme_right_white_ffffff.png?resize=149%2C149\" alt=\"Fork me on GitHub\" data-recalc-dims=\"1\" />\r\n            </a>\r\n\r\n        </>);\r\n    }\r\n\r\n    private handleKeyPress(event: React.KeyboardEvent<HTMLInputElement>) {\r\n        if (event.key === 'Enter') {\r\n            // Otherwise the event will bubble up and the form will be submitted\r\n            event.preventDefault();\r\n\r\n            this.props.state.load();\r\n        }\r\n    }\r\n}\r\n","import { FunctionsMap } from './shared/FunctionsMap';\r\n\r\nconst space = '#32;';\r\n\r\nfunction getTriggerBindingText(binding: any): string {\r\n\r\n    switch (binding.type) {\r\n        case 'httpTrigger':\r\n            return `http${!binding.methods ? '' : ':[' + binding.methods.join(',') + ']'}${!binding.route ? '' : ':' + binding.route}`;\r\n        case 'blobTrigger':\r\n            return `blob:${binding.path ?? ''}`;\r\n        case 'cosmosDBTrigger':\r\n            return `cosmosDB:${binding.databaseName ?? ''}:${binding.collectionName ?? ''}`;\r\n        case 'eventHubTrigger':\r\n            return `eventHub:${binding.eventHubName ?? ''}`;\r\n        case 'serviceBusTrigger':\r\n            return `serviceBus:${!binding.queueName ? (binding.topicName ?? '') : binding.queueName}${!binding.subscriptionName ? '' : ':' + binding.subscriptionName}`;\r\n        case 'queueTrigger':\r\n            return `queue:${binding.queueName ?? ''}`;\r\n        case 'timerTrigger':\r\n            return `timer:${binding.schedule ?? ''}`;\r\n        default:\r\n            return binding.type;\r\n    }\r\n}\r\n\r\nfunction getBindingText(binding: any): string {\r\n\r\n    switch (binding.type) {\r\n        case 'table':\r\n            return `table:${binding.tableName ?? ''}`;\r\n        case 'blob':\r\n            return `blob:${binding.path ?? ''}`;\r\n        case 'cosmosDB':\r\n            return `cosmosDB:${binding.databaseName ?? ''}:${binding.collectionName ?? ''}`;\r\n        case 'eventHub':\r\n            return `eventHub:${binding.eventHubName ?? ''}`;\r\n        case 'serviceBus':\r\n            return `serviceBus:${!binding.queueName ? (binding.topicName ?? '') : binding.queueName}${!binding.subscriptionName ? '' : ':' + binding.subscriptionName}`;\r\n        case 'queue':\r\n            return `queue:${binding.queueName ?? ''}`;\r\n        default:\r\n            return binding.type;\r\n    }\r\n}\r\n\r\n// Translates functions and their bindings into a Mermaid Flowchart diagram code\r\nexport function buildFunctionDiagramCode(funcs: FunctionsMap): string {\r\n\r\n    const functions = [];\r\n\r\n    // Determine what kind of function this one is\r\n    for (const name in funcs) {\r\n        const func = funcs[name];\r\n\r\n        var triggerBinding = undefined, inputBindings = [], outputBindings = [], otherBindings = [];\r\n        var nodeCode = `${name}{{\"${space}${name}\"}}:::function`;\r\n\r\n        for (const binding of func.bindings) {\r\n\r\n            if (binding.type === 'orchestrationTrigger') {\r\n                nodeCode = `${name}[[\"${space}${name}\"]]:::orchestrator`;\r\n            } else if (binding.type === 'activityTrigger') {\r\n                nodeCode = `${name}[/\"${space}${name}\"/]:::activity`;\r\n            } else if (binding.type === 'entityTrigger') {\r\n                nodeCode = `${name}[(\"${space}${name}\")]:::entity`;\r\n            }\r\n\r\n            if (binding.type.endsWith('Trigger')) {\r\n                triggerBinding = binding;\r\n            } else if (binding.direction === 'in') {\r\n                inputBindings.push(binding);\r\n            } else if (binding.direction === 'out') {\r\n                outputBindings.push(binding);\r\n            } else {\r\n                otherBindings.push(binding);\r\n            }\r\n        }\r\n\r\n        functions.push({ name, nodeCode, triggerBinding, inputBindings, outputBindings, otherBindings, ...func });\r\n    }\r\n\r\n    // Sorting by trigger type, then by name\r\n    functions.sort((f1, f2) => {\r\n\r\n        var s1 = (!!f1.isCalledBy?.length || !f1.triggerBinding || !f1.triggerBinding.type) ? '' : f1.triggerBinding.type;\r\n        s1 += '~' + f1.name;\r\n\r\n        var s2 = (!!f2.isCalledBy?.length || !f2.triggerBinding || !f2.triggerBinding.type) ? '' : f2.triggerBinding.type;\r\n        s2 += '~' + f2.name;\r\n\r\n        return (s1 > s2) ? 1 : ((s2 > s1) ? -1 : 0);\r\n    });\r\n\r\n    // Rendering\r\n    var code = '';\r\n    for (const func of functions) {\r\n\r\n        code += `${func.nodeCode}\\n`;\r\n\r\n        if (!!func.isCalledBy?.length) {\r\n\r\n            for (const calledBy of func.isCalledBy) {\r\n                code += `${calledBy} --> ${func.name}\\n`;\r\n            }\r\n\r\n        } else if (!!func.triggerBinding) {\r\n\r\n            code += `${func.name}.${func.triggerBinding.type}>\"${space}${getTriggerBindingText(func.triggerBinding)}\"]:::${func.triggerBinding.type} --> ${func.name}\\n`;\r\n        }\r\n\r\n        for (const inputBinding of func.inputBindings) {\r\n            code += `${func.name}.${inputBinding.type}([\"${space}${getBindingText(inputBinding)}\"]):::${inputBinding.type} -.-> ${func.name}\\n`;\r\n        }\r\n\r\n        for (const outputBinding of func.outputBindings) {\r\n            code += `${func.name} -.-> ${func.name}.${outputBinding.type}([\"${space}${getBindingText(outputBinding)}\"]):::${outputBinding.type}\\n`;\r\n        }\r\n\r\n        for (const otherBinding of func.otherBindings) {\r\n            code += `${func.name} -.- ${func.name}.${otherBinding.type}([\"${space}${getBindingText(otherBinding)}\"]):::${otherBinding.type}\\n`;\r\n        }\r\n\r\n        if (!!func.isSignalledBy?.length) {\r\n\r\n            for (const signalledBy of func.isSignalledBy) {\r\n                code += `${signalledBy.name} -. \"#9889; ${signalledBy.signalName}\" .-> ${func.name}\\n`;\r\n            }\r\n        }\r\n\r\n        if (!!func.isCalledByItself) {\r\n\r\n            code += `${func.name} -- \"[ContinueAsNew]\" --> ${func.name}\\n`;\r\n        }\r\n    }\r\n\r\n    return code;\r\n}","import { observable, computed } from 'mobx';\r\nimport axios from 'axios';\r\nimport mermaid from 'mermaid';\r\n\r\nimport { buildFunctionDiagramCode } from './buildFunctionDiagramCode';\r\n\r\nexport class AppState {\r\n\r\n    @computed\r\n    get diagramSvg(): string { return this._diagramSvg; }\r\n\r\n    @computed\r\n    get diagramCode(): string { return this._diagramCode; }\r\n\r\n    @computed\r\n    get error(): string { return this._error; }\r\n\r\n    @observable\r\n    pathText: string = \"\";\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    constructor() {\r\n        mermaid.initialize({\r\n            startOnLoad: true,\r\n\r\n            flowchart: {\r\n                curve: 'Basis',\r\n                useMaxWidth: true,\r\n                htmlLabels: false\r\n            }\r\n        });\r\n    }\r\n\r\n    load() {\r\n\r\n        if (this._inProgress || !this.pathText) {\r\n            return;\r\n        }\r\n        this._inProgress = true;\r\n        this._error = '';\r\n        this._diagramCode = '';\r\n        this._diagramSvg = '';\r\n\r\n        const projectPath = this.pathText;\r\n        window.history.replaceState(null, null, `?path=${encodeURIComponent(projectPath)}`);\r\n        this.pathText = '';\r\n\r\n        const traversedFunctionsPromise = axios.post(`a/p/i/traverse-func`, projectPath);\r\n\r\n        Promise.all([traversedFunctionsPromise, this._iconsSvgPromise]).then(responses => {\r\n\r\n            try {\r\n                const diagramCode = buildFunctionDiagramCode(responses[0].data);\r\n                const iconsSvg = responses[1].data;\r\n\r\n                if (!diagramCode) {\r\n                    this._inProgress = false;\r\n                    return;\r\n                }\r\n\r\n                this._diagramCode = `graph LR\\n${diagramCode}`;\r\n\r\n                mermaid.render('mermaidSvgId', this._diagramCode, (svg) => {\r\n\r\n                    this._diagramSvg = this.applyIcons(svg, iconsSvg);\r\n\r\n                    this._inProgress = false;\r\n                });\r\n\r\n            } catch (err) {\r\n                this._error = `Diagram generation failed: ${err.message}`;\r\n                this._inProgress = false;\r\n            }\r\n\r\n        }, err => {\r\n            this._error = `Parsing failed: ${err.message}.${(!!err.response ? err.response.data : '')}`;\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    private applyIcons(svg: string, iconsSvg: string): string {\r\n\r\n        // Placing icons code into a <defs> block at the top\r\n        svg = svg.replace(`><style>`, `>\\n<defs>\\n${iconsSvg}</defs>\\n<style>`);\r\n\r\n        // Adding <use> blocks referencing relevant icons\r\n        svg = svg.replace(/<g class=\"node (\\w+).*?<g class=\"label\" transform=\"translate\\([0-9,.-]+\\)\"><g transform=\"translate\\([0-9,.-]+\\)\">/g,\r\n            `$&<use href=\"#az-icon-$1\" width=\"20px\" height=\"20px\"/>`);\r\n\r\n        return svg;\r\n    }\r\n\r\n    @observable\r\n    private _error: string;\r\n    @observable\r\n    private _diagramCode: string;\r\n    @observable\r\n    private _diagramSvg: string;\r\n    @observable\r\n    private _inProgress: boolean;\r\n\r\n    private _iconsSvgPromise = axios.get('static/icons/all-azure-icons.svg');\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport { AppState } from './AppState';\r\n\r\nReactDOM.render(<App state={new AppState()} />, document.getElementById('root'));\r\n"],"sourceRoot":""}