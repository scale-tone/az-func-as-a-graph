(()=>{"use strict";var e={1413:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileSystemWrapper=void 0;const i=s(9496),r=s(9519);class n extends r.FileSystemWrapperBase{joinPath(e,t){return i.Uri.joinPath(i.Uri.parse(e),t).toString()}dirName(e){const t=e.lastIndexOf("/");if(t<0)throw new Error(`Failed to extract parent folder name from path ${e}. The path does not contain a separator.`);return e.substring(0,t)}async readFile(e){const t=i.Uri.parse(e),s=await i.workspace.fs.readFile(t);return(new TextDecoder).decode(s)}async isDirectory(e){const t=i.Uri.parse(e);return(await i.workspace.fs.stat(t)).type===i.FileType.Directory}async readDir(e){const t=i.Uri.parse(e);return(await i.workspace.fs.readDirectory(t)).map((e=>e[0]))}async pathExists(e){const t=i.Uri.parse(e);try{const e=await i.workspace.fs.stat(t);return e.type===i.FileType.File||e.type===i.FileType.Directory}catch(e){return!1}}}t.FileSystemWrapper=n},2083:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionGraphView=void 0;const i=s(9496),r=s(5970),n=s(1413);class a{constructor(e,t){this._context=e,this._functionProjectUri=t,this._webViewPanel=null,this._staticsFolder=i.Uri.joinPath(this._context.extensionUri,"HtmlStatics"),this._webViewPanel=this.showWebView()}cleanup(){this._webViewPanel&&this._webViewPanel.dispose()}showWebView(){const e=`Functions Graph (${this._functionProjectUri.fsPath})`,t=i.window.createWebviewPanel(a.viewType,e,i.ViewColumn.One,{retainContextWhenHidden:!0,enableScripts:!0,localResourceRoots:[this._staticsFolder]}),s=i.Uri.joinPath(this._staticsFolder,"index.html");return i.workspace.fs.readFile(s).then((e=>{let s=(new TextDecoder).decode(e);s=this.fixLinksToStatics(s,this._staticsFolder,t.webview),s=this.embedTheme(s),t.webview.html=s}),(e=>{i.window.showErrorMessage(`az-func-as-a-graph failed. ${e.message??e}`)})),t.webview.onDidReceiveMessage((e=>this.handleMessageFromWebView(t.webview,e)),void 0,this._context.subscriptions),t}embedTheme(e){return[2,3].includes(i.window.activeColorTheme.kind)?e.replace("<script>var ClientConfig={}<\/script>","<script>var ClientConfig={'theme':'dark'}<\/script>"):e}handleMessageFromWebView(e,t){switch(t.kind){case"ShowMessage":return void i.window.showInformationMessage(t.data);case"ShowError":return void i.window.showErrorMessage(`az-func-as-a-graph failed. ${t.data}`);case"SaveAs":return this.looksLikeSvg(t.data)?void i.window.showSaveDialog({defaultUri:i.Uri.file("func-map.svg"),filters:{"SVG Images":["svg"]}}).then((e=>{if(!e)return;const s=(new TextEncoder).encode(t.data);i.workspace.fs.writeFile(e,s).then((()=>{i.window.showInformationMessage(`SVG image saved to ${e}`)}),(e=>{i.window.showErrorMessage(`Failed to save. ${e.message??e}`)}))})):void i.window.showErrorMessage("Invalid data format. Save failed.");case"SaveFunctionGraphAsJson":if(!this._traversalResult)return;return void i.window.showSaveDialog({defaultUri:i.Uri.file("func-map.json"),filters:{JSON:["json"]}}).then((e=>{if(!e)return;const t=(new TextEncoder).encode(JSON.stringify(this._traversalResult,null,3));i.workspace.fs.writeFile(e,t).then((()=>{i.window.showInformationMessage(`Diagram JSON saved to ${e}`)}),(e=>{i.window.showErrorMessage(`Failed to save. ${e.message??e}`)}))}));case"GotoFunctionCode":if(!this._traversalResult)return;const a=t.data;var s;return s=a.startsWith("proxy.")?this._traversalResult.proxies[a.substr(6)]:this._traversalResult.functions[a],void i.window.showTextDocument(i.Uri.parse(s.filePath)).then((e=>{const t=e.document.positionAt(s.pos?s.pos:0);e.selection=new i.Selection(t,t),e.revealRange(new i.Range(t,t))}));case"Refresh":return void r.FunctionProjectParser.parseFunctions(this._functionProjectUri.toString(),new n.FileSystemWrapper,console.log).then((t=>{this._traversalResult=t,e.postMessage(this._traversalResult)})).catch((t=>{this._traversalResult=void 0,e.postMessage(void 0),i.window.showErrorMessage(`az-func-as-a-graph failed. ${t.message??t}`)}))}}fixLinksToStatics(e,t,s){var r=e;const n=/ (href|src)="\/([0-9a-z.\/]+)"/gi;for(var a;a=n.exec(e);){const e=a[2],n=i.Uri.joinPath(t,e),o=s.asWebviewUri(n).toString();r=r.replace(`/${e}`,o)}return r}looksLikeSvg(e){return e.startsWith("<svg")&&e.endsWith("</svg>")&&!e.toLowerCase().includes("<script")}}t.FunctionGraphView=a,a.viewType="az-func-as-a-graph"},9519:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileSystemWrapperBase=void 0;const i=s(8605),r=["node_modules","obj",".vs",".vscode",".env",".python_packages",".git",".github"];t.FileSystemWrapperBase=class{async readFunctionsJson(e,t){let s={};const i=(await this.readDir(e)).map((async i=>{const r=this.joinPath(e,i),n=this.joinPath(r,"function.json"),a=await this.isDirectory(r),o=await this.pathExists(n);if(a&&o)try{const e=await this.readFile(n),t=JSON.parse(e);s[i]={bindings:t.bindings,isCalledBy:[],isSignalledBy:[]}}catch(e){t(`>>> Failed to parse ${n}: ${e}`)}}));return await Promise.all(i),s}async readProxiesJson(e,t){const s=this.joinPath(e,"proxies.json");if(!await this.pathExists(s))return{};const r=await this.readFile(s);try{const t=JSON.parse(r).proxies;if(!t)return{};var n=!1;if(await this.isCSharpProjectAsync(e)){const t=await this.findFileRecursivelyAsync(e,".+\\.csproj$",!0),s=new RegExp('\\s*=\\s*"proxies.json"\\s*>');t&&t.code&&!s.exec(t.code)&&(n=!0)}for(var a in t){const e=t[a];e.filePath=s,n&&(e.warningNotAddedToCsProjFile=!0);const o=new RegExp(`"${a}"\\s*:`).exec(r);o&&(e.pos=o.index,e.lineNr=(0,i.posToLineNr)(r,e.pos))}return t}catch(e){return t(`>>> Failed to parse ${s}: ${e}`),{}}}async isCSharpProjectAsync(e){return(await this.readDir(e)).some((e=>(e=e.toLowerCase()).endsWith(".csproj")&&"extensions.csproj"!==e))}async isFSharpProjectAsync(e){return(await this.readDir(e)).some((e=>(e=e.toLowerCase()).endsWith(".fsproj")))}async isJavaProjectAsync(e){return!!await this.findFileRecursivelyAsync(e,".+\\.java$",!1)}async findFileRecursivelyAsync(e,t,s,i){const n="string"==typeof t?new RegExp(t,"i"):t,a=[];for(const t of await this.readDir(e)){const o=this.joinPath(e,t);if(await this.isDirectory(o))r.includes(t.toLowerCase())||a.push(o);else if(n.exec(t)){if(!i)return{filePath:o,code:s?await this.readFile(o):void 0};const e=await this.readFile(o),t=i.exec(e);if(t)return{filePath:o,code:s?e:void 0,pos:t.index,length:t[0].length}}}for(const e of a){const t=await this.findFileRecursivelyAsync(e,n,s,i);if(t)return t}}async*findFunctionsRecursivelyAsync(e,t,s,n){for(const c of await this.readDir(e)){var a=this.joinPath(e,c);if(await this.isDirectory(a)){if(r.includes(c.toLowerCase()))continue;for await(const e of this.findFunctionsRecursivelyAsync(a,t,s,n))yield e}else if(t.exec(c)){const e=await this.readFile(a);for(var o;o=s.exec(e);){let t=(0,i.cleanupFunctionName)(o[n]);const s=o.index+o[0].length,r=(0,i.getCodeInBrackets)(e,s,"{","}","\n");if(!(r.openBracketPos>=0&&r.code)){yield{functionName:t,filePath:a,pos:o.index,lineNr:(0,i.posToLineNr)(e,o.index),declarationCode:e.substring(s),bodyCode:e.substring(s)};break}yield{functionName:t,filePath:a,pos:o.index,lineNr:(0,i.posToLineNr)(e,o.index),declarationCode:r.code.substring(0,r.openBracketPos),bodyCode:r.code.substring(r.openBracketPos)}}}}}}},5970:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionProjectParser=void 0;const i=s(8605);class r{static async parseFunctions(e,t,s){const i=await t.findFileRecursivelyAsync(e,"host.json",!1);if(!i)throw new Error("host.json file not found under the provided project path");s(`>>> Found host.json at ${i.filePath}`);const r=t.dirName(i.filePath);let a;return await t.isCSharpProjectAsync(r)?a=new o(t,s):await t.isFSharpProjectAsync(r)?a=new c(t,s):await t.isJavaProjectAsync(r)?a=new u(t,s):(a=new n(t,s),e=r),{functions:await a.traverseFunctions(e),proxies:await t.readProxiesJson(e,s),projectFolder:e}}constructor(e,t){this._fileSystemWrapper=e,this._log=t}async mapOrchestratorsAndActivitiesAsync(e,t){const s=Object.keys(e),r=s.filter((t=>e[t].bindings.some((e=>"orchestrationTrigger"===e.type)))),n=await this.getFunctionsAndTheirCodesAsync(r,t),a=Object.keys(e).filter((t=>e[t].bindings.some((e=>"activityTrigger"===e.type)))),o=await this.getFunctionsAndTheirCodesAsync(a,t),c=s.filter((t=>e[t].bindings.some((e=>"entityTrigger"===e.type)))),u=await this.getFunctionsAndTheirCodesAsync(c,t),l=s.filter((t=>!e[t].bindings.some((e=>["orchestrationTrigger","activityTrigger","entityTrigger"].includes(e.type))))),g=await this.getFunctionsAndTheirCodesAsync(l,t);for(const t of n){const s=i.TraversalRegexes.getStartNewOrchestrationRegex(t.name);for(const i of g)s.exec(i.code)&&(e[t.name].isCalledBy=e[t.name].isCalledBy??[],e[t.name].isCalledBy.push(i.name));for(const s of n)t.name!==s.name&&i.TraversalRegexes.getCallSubOrchestratorRegex(s.name).exec(t.code)&&(e[s.name].isCalledBy=e[s.name].isCalledBy??[],e[s.name].isCalledBy.push(t.name));(0,i.mapActivitiesToOrchestrator)(e,t,a),i.TraversalRegexes.continueAsNewRegex.exec(t.code)&&(e[t.name].isCalledByItself=!0);const r=(0,i.getEventNames)(t.code);for(const s of r){const r=i.TraversalRegexes.getRaiseEventRegex(s);for(const i of g)r.exec(i.code)&&(e[t.name].isSignalledBy=e[t.name].isSignalledBy??[],e[t.name].isSignalledBy.push({name:i.name,signalName:s}))}}for(const t of u)for(const s of g)i.TraversalRegexes.getSignalEntityRegex(t.name).exec(s.code)&&(e[t.name].isCalledBy=e[t.name].isCalledBy??[],e[t.name].isCalledBy.push(s.name));for(const t of g.concat(n).concat(o).concat(u))e[t.name].filePath=t.filePath,e[t.name].pos=t.pos,e[t.name].lineNr=t.lineNr;return e}}t.FunctionProjectParser=r;class n extends r{async traverseFunctions(e){let t;return t=await this._fileSystemWrapper.readFunctionsJson(e,this._log),t=await this.mapOrchestratorsAndActivitiesAsync(t,e),t}async getFunctionsAndTheirCodesAsync(e,t){const s=e.map((async e=>{let s=await this._fileSystemWrapper.findFileRecursivelyAsync(this._fileSystemWrapper.joinPath(t,e),"(index\\.ts|index\\.js|__init__\\.py)$",!0);if(!s)return;const r=s.pos?s.pos:0,n=(0,i.posToLineNr)(s.code,r);return{name:e,code:s.code,filePath:s.filePath,pos:r,lineNr:n}}));return(await Promise.all(s)).filter((e=>!!e))}}class a extends r{async traverseFunctions(e){let t;return t=await this.traverseProjectCode(e),t=await this.mapOrchestratorsAndActivitiesAsync(t,e),t}}class o extends a{async getFunctionsAndTheirCodesAsync(e,t){const s=e.map((async e=>{const s=await this._fileSystemWrapper.findFileRecursivelyAsync(t,".+\\.cs$",!0,i.TraversalRegexes.getDotNetFunctionNameRegex(e));if(!s)return;const r=s.pos?s.pos:0,n=(0,i.posToLineNr)(s.code,r);return{name:e,code:(0,i.getCodeInBrackets)(s.code,s.pos+s.length,"{","}","\n").code,filePath:s.filePath,pos:r,lineNr:n}}));return(await Promise.all(s)).filter((e=>!!e))}async traverseProjectCode(e){const t={},s=new RegExp(".+\\.cs$","i");for await(const r of this._fileSystemWrapper.findFunctionsRecursivelyAsync(e,s,i.BindingsParser.functionAttributeRegex,3)){const n=i.BindingsParser.tryExtractBindings(r.declarationCode);n.some((e=>"orchestrationTrigger"===e.type))||n.some((e=>"entityTrigger"===e.type))||n.some((e=>"activityTrigger"===e.type))||n.push(...await this.extractOutputBindings(e,r.declarationCode,s)),t[r.functionName]={filePath:r.filePath,pos:r.pos,lineNr:r.lineNr,bindings:[...n]}}return t}async extractOutputBindings(e,t,s){const r=i.BindingsParser.functionReturnTypeRegex.exec(t);if(!r)return[];const n=(0,i.removeNamespace)(r[3]);if(!n)return[];const a=await this._fileSystemWrapper.findFileRecursivelyAsync(e,s,!0,i.TraversalRegexes.getClassDefinitionRegex(n));if(!a)return[];const o=(0,i.getCodeInBrackets)(a.code,(a.pos??0)+(a.length??0),"{","}");return o.code?i.BindingsParser.tryExtractBindings(o.code):[]}}class c extends a{async getFunctionsAndTheirCodesAsync(e,t){const s=e.map((async e=>{const s=await this._fileSystemWrapper.findFileRecursivelyAsync(t,".+\\.fs$",!0,i.TraversalRegexes.getDotNetFunctionNameRegex(e));if(!s)return;const r=(0,i.getCodeInBrackets)(s.code,s.pos+s.length,"{","}","\n").code,n=s.pos?s.pos:0,a=(0,i.posToLineNr)(s.code,n);return{name:e,code:r,filePath:s.filePath,pos:n,lineNr:a}}));return(await Promise.all(s)).filter((e=>!!e))}async traverseProjectCode(e){const t={};for await(const s of this._fileSystemWrapper.findFunctionsRecursivelyAsync(e,new RegExp(".+\\.fs$","i"),i.BindingsParser.fSharpFunctionAttributeRegex,2)){const e=i.BindingsParser.tryExtractBindings(s.declarationCode);t[s.functionName]={filePath:s.filePath,pos:s.pos,lineNr:s.lineNr,bindings:[...e]}}return t}}class u extends a{async getFunctionsAndTheirCodesAsync(e,t){const s=e.map((async e=>{const s=await this._fileSystemWrapper.findFileRecursivelyAsync(t,".+\\.java$",!0,i.TraversalRegexes.getDotNetFunctionNameRegex(e));if(!s)return;const r=(0,i.getCodeInBrackets)(s.code,s.pos+s.length,"{","}","\n").code,n=s.pos?s.pos:0,a=(0,i.posToLineNr)(s.code,n);return{name:e,code:r,filePath:s.filePath,pos:n,lineNr:a}}));return(await Promise.all(s)).filter((e=>!!e))}async traverseProjectCode(e){const t={};for await(const s of this._fileSystemWrapper.findFunctionsRecursivelyAsync(e,new RegExp(".+\\.java$","i"),i.BindingsParser.javaFunctionAttributeRegex,1)){const e=i.BindingsParser.tryExtractBindings(s.declarationCode);t[s.functionName]={filePath:s.filePath,pos:s.pos,lineNr:s.lineNr,bindings:[...e]}}return t}}},8605:(e,t)=>{function s(e){if(!e)return e;const t=e.lastIndexOf(".");return t>=0&&(e=e.substring(t+1)),e.trim()}function i(e,t,s,i,r=""){for(var n=0,a=-1,o=!r,c=t;c<e.length;c++){switch(e[c]){case s:n<=0&&(a=c),n++;break;case i:if(--n<=0&&o)return{code:e.substring(t,c+1),openBracketPos:a-t}}n>0&&r.includes(e[c])&&(o=!0)}return{code:"",openBracketPos:-1}}Object.defineProperty(t,"__esModule",{value:!0}),t.BindingsParser=t.TraversalRegexes=t.getCodeInBracketsReverse=t.getCodeInBrackets=t.posToLineNr=t.mapActivitiesToOrchestrator=t.getEventNames=t.removeNamespace=t.cleanupFunctionName=void 0,t.cleanupFunctionName=function(e){if(!e)return e;const t=new RegExp("nameof\\s*\\(\\s*([\\w\\.]+)\\s*\\)").exec(e);return t?s(t[1]):(e=e.trim()).startsWith('"')?e.replace(/^"/,"").replace(/"$/,""):s(e)},t.removeNamespace=s,t.getEventNames=function(e){const t=[],s=r.waitForExternalEventRegex;for(var i;i=s.exec(e);)t.push(i[4]);return t},t.mapActivitiesToOrchestrator=function(e,t,s){for(const i of s)r.getCallActivityRegex(i).exec(t.code)&&(e[i].isCalledBy=e[i].isCalledBy??[],e[i].isCalledBy.push(t.name))},t.posToLineNr=function(e,t){if(!e)return 0;const s=e.substr(0,t).match(/(\r\n|\r|\n)/g);return s?s.length+1:1},t.getCodeInBrackets=i,t.getCodeInBracketsReverse=function(e,t,s){for(var i=0,r=0,n=e.length-1;n>=0;n--)switch(e[n]){case s:i<=0&&(r=n),i++;break;case t:if(--i<=0)return{code:e.substring(0,r+1),openBracketPos:n}}return{code:"",openBracketPos:-1}};class r{static getStartNewOrchestrationRegex(e){return new RegExp(`(StartNew|StartNewAsync|start_new|scheduleNewOrchestrationInstance)(\\s*<[\\w\\.-\\[\\]\\<\\>,\\s]+>)?\\s*\\(\\s*(["'\`]|nameof\\s*\\(\\s*[\\w\\.-]*|[\\w\\s\\.]+\\.\\s*)${e}\\s*["'\\),]{1}`,"i")}static getCallSubOrchestratorRegex(e){return new RegExp(`(CallSubOrchestrator|CallSubOrchestratorWithRetry|call_sub_orchestrator)(Async)?(\\s*<[\\w\\.-\\[\\]\\<\\>,\\s]+>)?\\s*\\(\\s*(["'\`]|nameof\\s*\\(\\s*[\\w\\.-]*|[\\w\\s\\.]+\\.\\s*)${e}\\s*["'\\),]{1}`,"i")}static getRaiseEventRegex(e){return new RegExp(`(RaiseEvent|raise_event)(Async)?(.|\r|\n)*${e}`,"i")}static getSignalEntityRegex(e){return new RegExp(`${e}\\s*["'>]{1}`)}static getDotNetFunctionNameRegex(e){return new RegExp(`FunctionName(Attribute)?\\s*\\(\\s*(nameof\\s*\\(\\s*|["'\`]|[\\w\\s\\.]+\\.\\s*)${e}\\s*["'\`\\)]{1}`)}static getJavaFunctionNameRegex(e){return new RegExp(`@\\s*FunctionName\\s*\\(["\\s\\w\\.-]*${e}"?\\)`)}static getCallActivityRegex(e){return new RegExp(`(CallActivity|call_activity)[\\s\\w,\\.-<>\\[\\]\\(\\)\\?]*\\([\\s\\w\\.-]*["'\`]?${e}\\s*["'\`\\),]{1}`,"i")}static getClassDefinitionRegex(e){return new RegExp(`class\\s*${e}`)}}t.TraversalRegexes=r,r.continueAsNewRegex=new RegExp("ContinueAsNew\\s*\\(","i"),r.waitForExternalEventRegex=new RegExp("(WaitForExternalEvent|wait_for_external_event)(<[\\s\\w,\\.-\\[\\]\\(\\)\\<\\>]+>)?\\s*\\(\\s*(nameof\\s*\\(\\s*|[\"'`]|[\\w\\s\\.]+\\.\\s*)?([\\s\\w\\.-]+)\\s*[\"'`\\),]{1}","gi");class n{static tryExtractBindings(e){const t=[];if(!e)return t;const s=this.bindingAttributeRegex;for(var r;r=s.exec(e);){const s=!!r[3];let n=r[4];n.endsWith("Attribute")&&(n=n.substring(0,n.length-"Attribute".length));const a=r.index+r[0].length,o=i(e,a,"(",")","").code;this.isOutRegex.lastIndex=a+o.length;const c=!!this.isOutRegex.exec(e);switch(n){case"BlobInput":case"BlobOutput":case"Blob":{const e={type:"blob",direction:"Blob"===n?s||c?"out":"in":"BlobOutput"===n?"out":"in"},i=this.blobParamsRegex.exec(o);i&&(e.path=i[1]),t.push(e);break}case"BlobTrigger":{const e={type:"blobTrigger"},s=this.blobParamsRegex.exec(o);s&&(e.path=s[1]),t.push(e);break}case"TableInput":case"TableOutput":case"Table":{const e={type:"table",direction:"Table"===n?s||c?"out":"in":"TableOutput"===n?"out":"in"},i=this.singleParamRegex.exec(o);i&&(e.tableName=i[2]),t.push(e);break}case"CosmosDBInput":case"CosmosDBOutput":case"CosmosDB":{const e={type:"cosmosDB",direction:"CosmosDB"===n?s||c?"out":"in":"CosmosDBOutput"===n?"out":"in"},i=this.cosmosDbParamsRegex.exec(o);i&&(e.databaseName=i[1],e.collectionName=i[3]),t.push(e);break}case"CosmosDBTrigger":{const e={type:"cosmosDBTrigger"},s=this.singleParamRegex.exec(o);s&&(e.databaseName=s[2]),t.push(e);break}case"EventGrid":case"EventGridOutput":{const e={type:"eventGrid",direction:"out"},s=this.eventGridParamsRegex.exec(o);s&&(e.topicEndpointUri=s[1],e.topicKeySetting=s[3]),t.push(e);break}case"EventGridTrigger":{const e={type:"eventGridTrigger"},s=this.eventGridParamsRegex.exec(o);s&&(e.topicEndpointUri=s[1],e.topicKeySetting=s[3]),t.push(e);break}case"EventHub":case"EventHubOutput":{const e={type:"eventHub",direction:"out"},s=this.eventHubParamsRegex.exec(o);s&&(e.eventHubName=s[1]),t.push(e);break}case"EventHubTrigger":{const e={type:"eventHubTrigger"},s=this.eventHubParamsRegex.exec(o);s&&(e.eventHubName=s[1]),t.push(e);break}case"Kafka":case"KafkaOutput":{const e={type:"kafka",direction:"out"},s=this.singleParamRegex.exec(o);s&&(e.brokerList=s[2]),t.push(e);break}case"KafkaTrigger":{const e={type:"kafkaTrigger"},s=this.singleParamRegex.exec(o);s&&(e.brokerList=s[2]),t.push(e);break}case"Queue":case"QueueOutput":{const e={type:"queue",direction:"out"},s=this.singleParamRegex.exec(o);s&&(e.queueName=s[2]),t.push(e);break}case"QueueTrigger":{const e={type:"queueTrigger"},s=this.singleParamRegex.exec(o);s&&(e.queueName=s[2]),t.push(e);break}case"ServiceBus":case"ServiceBusOutput":{const e={type:"serviceBus",direction:"out"},s=this.singleParamRegex.exec(o);s&&(e.queueName=s[2]),t.push(e);break}case"ServiceBusTrigger":case"ServiceBusQueueTrigger":case"ServiceBusTopicTrigger":{const e={type:"serviceBusTrigger"},s=this.singleParamRegex.exec(o);s&&(e.queueName=s[2]),t.push(e);break}case"SignalRConnectionInfo":case"SignalRConnectionInfoInput":{const e={type:"signalRConnectionInfo",direction:"in"},s=this.signalRConnInfoParamsRegex.exec(o);s&&(e.hubName=s[1]),t.push(e);break}case"SignalR":case"SignalROutput":{const e={type:"signalR",direction:"out"},s=this.signalRParamsRegex.exec(o);s&&(e.hubName=s[1]),t.push(e);break}case"SignalRTrigger":{const e={type:"signalRTrigger"},s=this.signalRParamsRegex.exec(o);s&&(e.hubName=s[1]),t.push(e);break}case"RabbitMQ":case"RabbitMQOutput":{const e={type:"rabbitMQ",direction:"out"},s=this.rabbitMqParamsRegex.exec(o);s&&(e.queueName=s[1]),t.push(e);break}case"RabbitMQTrigger":{const e={type:"rabbitMQTrigger"},s=this.rabbitMqParamsRegex.exec(o);s&&(e.queueName=s[1]),t.push(e);break}case"SendGrid":case"SendGridOutput":t.push({type:"sendGrid",direction:"out"});break;case"TwilioSms":t.push({type:"twilioSms",direction:"out"});break;case"HttpTrigger":{const e={type:"httpTrigger",methods:[]},s=this.httpTriggerRouteRegex.exec(o);s&&(e.route=s[1]);const i=o.toLowerCase();for(const t of this.httpMethods)i.includes(`"${t}"`)&&e.methods.push(t);t.push(e),t.push({type:"http",direction:"out"});break}case"OrchestrationTrigger":case"DurableOrchestrationTrigger":t.push({type:"orchestrationTrigger",direction:"in"});break;case"ActivityTrigger":case"DurableActivityTrigger":t.push({type:"activityTrigger",direction:"in"});break;case"EntityTrigger":case"DurableEntityTrigger":t.push({type:"entityTrigger",direction:"in"});break;default:t.push({type:n,direction:s||c?"out":"in"})}}return t}}t.BindingsParser=n,n.bindingAttributeRegex=new RegExp("(\\[|@)(<)?\\s*(return:)?\\s*(\\w+)","g"),n.singleParamRegex=new RegExp('("|nameof\\s*\\()?([\\w\\.-]+)'),n.eventHubParamsRegex=new RegExp('"([^"]+)"'),n.signalRParamsRegex=new RegExp('"([^"]+)"'),n.rabbitMqParamsRegex=new RegExp('"([^"]+)"'),n.blobParamsRegex=new RegExp('"([^"]+)"'),n.cosmosDbParamsRegex=new RegExp('"([^"]+)"(.|\r|\n)+?"([^"]+)"'),n.signalRConnInfoParamsRegex=new RegExp('"([^"]+)"'),n.eventGridParamsRegex=new RegExp('"([^"]+)"(.|\r|\n)+?"([^"]+)"'),n.isOutRegex=new RegExp("^\\s*\\]\\s*(out |ICollector|IAsyncCollector).*?(,|\\()","g"),n.httpMethods=["get","head","post","put","delete","connect","options","trace","patch"],n.httpTriggerRouteRegex=new RegExp('Route\\s*=\\s*"(.*)"'),n.functionAttributeRegex=new RegExp('\\[\\s*Function(Name)?(Attribute)?\\s*\\((["\\w\\s\\.\\(\\)-]+)\\)\\s*\\]',"g"),n.functionReturnTypeRegex=new RegExp("public\\s*(static\\s*|async\\s*)*(Task\\s*<\\s*)?([\\w\\.]+)"),n.javaFunctionAttributeRegex=new RegExp('@\\s*FunctionName\\s*\\((["\\w\\s\\.\\(\\)-]+)\\)',"g"),n.fSharpFunctionAttributeRegex=new RegExp('\\[<\\s*Function(Name)?\\s*\\((["\\w\\s\\.\\(\\)-]+)\\)',"g")},9496:e=>{e.exports=require("vscode")}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}var i={};(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=s(9496),r=s(1413),n=s(2083);let a=[];e.activate=async function(e){const s=new r.FileSystemWrapper;if(e.subscriptions.push(t.commands.registerCommand("az-func-as-a-graph.ShowGraph",(async i=>{if(i){const r=i.toString();return void(r.toLowerCase().endsWith("host.json")&&a.push(new n.FunctionGraphView(e,t.Uri.parse(s.dirName(r)))))}if(!t.workspace.workspaceFolders)return;let r=!1;for(const i of t.workspace.workspaceFolders){const o=t.Uri.joinPath(i.uri,"host.json").toString();await s.pathExists(o)&&(a.push(new n.FunctionGraphView(e,i.uri)),r=!0)}!r&&t.workspace.workspaceFolders.length&&a.push(new n.FunctionGraphView(e,t.workspace.workspaceFolders[0].uri))}))),t.workspace.workspaceFolders&&t.workspace.getConfiguration("az-func-as-a-graph").get("showGraphAtStartup",!0))for(const i of t.workspace.workspaceFolders){const r=t.Uri.joinPath(i.uri,"host.json").toString();await s.pathExists(r)&&a.push(new n.FunctionGraphView(e,i.uri))}},e.deactivate=function(){for(const e of a)e.cleanup()}})();var r=exports;for(var n in i)r[n]=i[n];i.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();